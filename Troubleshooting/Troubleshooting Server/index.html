<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Troubleshooting Server - Support Portal</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../iconmoon.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Support Portal</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../Configuration/Advanced Login/">Advanced Login</a>
</li>
                            
<li >
    <a href="../../Configuration/Advanced Permissions/">Advanced Permissions</a>
</li>
                            
<li >
    <a href="../../Configuration/Backups/">Backups</a>
</li>
                            
<li >
    <a href="../../Configuration/Barcode/">Barcode</a>
</li>
                            
<li >
    <a href="../../Configuration/Branding/">Branding</a>
</li>
                            
<li >
    <a href="../../Configuration/Logging/">Logging</a>
</li>
                            
<li >
    <a href="../../Configuration/SSO/">SSO</a>
</li>
                            
<li >
    <a href="../../Configuration/Template Extraction/">Template Extraction</a>
</li>
                            
<li >
    <a href="../../Configuration/User Management/">User Management</a>
</li>
                            
<li >
    <a href="../../Configuration/WebScan/">WebScan</a>
</li>
                            
<li >
    <a href="../../Configuration/Yaml Config/">Yaml Config</a>
</li>
                            
<li >
    <a href="../../Configuration/basic/">Basic</a>
</li>
                            
<li >
    <a href="../../Configuration/indexes/">Indexes</a>
</li>
                            
<li >
    <a href="../../Configuration/security/">Security</a>
</li>
                            
<li >
    <a href="../../Configuration/solution-pack/">Solution pack</a>
</li>
                            
<li >
    <a href="../../Configuration/ssl/">Ssl</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Installation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../Installation/Desktop Agent/">Desktop Agent</a>
</li>
                            
<li >
    <a href="../../Installation/MS Office Add-in/">MS Office Add in</a>
</li>
                            
<li >
    <a href="../../Installation/Replication/">Replication</a>
</li>
                            
<li >
    <a href="../../Installation/Sizing/">Sizing</a>
</li>
                            
<li >
    <a href="../../Installation/Ubuntu-Linux/">Ubuntu Linux</a>
</li>
                            
<li >
    <a href="../../Installation/Windows/">Windows</a>
</li>
                            
<li >
    <a href="../../Installation/end-user-installation/">End user installation</a>
</li>
                            
<li >
    <a href="../../Installation/macosx/">Macosx</a>
</li>
                            
<li >
    <a href="../../Installation/server-installation/">Server installation</a>
</li>
                            
<li >
    <a href="../../Installation/service/">Service</a>
</li>
                            
<li >
    <a href="../../Installation/solution/">Solution</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Integration <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../Integration/Database/">Database</a>
</li>
                            
<li >
    <a href="../../Integration/EasyPDF/">EasyPDF</a>
</li>
                            
<li >
    <a href="../../Integration/Folder Export/">Folder Export</a>
</li>
                            
<li >
    <a href="../../Integration/data-sources/">Data sources</a>
</li>
                            
<li >
    <a href="../../Integration/email-watch/">Email watch</a>
</li>
                            
<li >
    <a href="../../Integration/folder-watch/">Folder watch</a>
</li>
                            
<li >
    <a href="../../Integration/ldap-ad/">Ldap ad</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../Reference/Cold Standby Failover Procedure/">Cold Standby Failover Procedure</a>
</li>
                            
<li >
    <a href="../../Reference/Document Properties/">Document Properties</a>
</li>
                            
<li >
    <a href="../../Reference/Encryption/">Encryption</a>
</li>
                            
<li >
    <a href="../../Reference/High Availability & Clustering/">High Availability & Clustering</a>
</li>
                            
<li >
    <a href="../../Reference/Linking/">Linking</a>
</li>
                            
<li >
    <a href="../../Reference/Logging/">Logging</a>
</li>
                            
<li >
    <a href="../../Reference/System-Nodes/">System Nodes</a>
</li>
                            
<li >
    <a href="../../Reference/health/">Health</a>
</li>
                            
<li >
    <a href="../../Reference/licensing/">Licensing</a>
</li>
                            
<li >
    <a href="../../Reference/linking_syntax/">Linking syntax</a>
</li>
                            
<li >
    <a href="../../Reference/maintenance/">Maintenance</a>
</li>
                            
<li >
    <a href="../../Reference/pql/">Pql</a>
</li>
                            
<li >
    <a href="../../Reference/regex/">Regex</a>
</li>
                            
<li >
    <a href="../../Reference/standard_expression/">Standard expression</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Troubleshooting <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../Performance/">Performance</a>
</li>
                            
<li >
    <a href="../Troubleshooting Client/">Troubleshooting Client</a>
</li>
                            
<li class="active">
    <a href="./">Troubleshooting Server</a>
</li>
                            
<li >
    <a href="../cpu-usage/">Cpu usage</a>
</li>
                            
<li >
    <a href="../db-tuning/">Db tuning</a>
</li>
                            
<li >
    <a href="../exceptions/">Exceptions</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../Troubleshooting Client/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../cpu-usage/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#troubleshooting-server">Troubleshooting Server</a></li>
            <li><a href="#isolate-the-problem">Isolate the Problem</a></li>
            <li><a href="#solve-the-problem">Solve the Problem</a></li>
            <li><a href="#log-levels">Log Levels</a></li>
            <li><a href="#rebuilding-indexes">Rebuilding Indexes</a></li>
            <li><a href="#message-queues">Message Queues</a></li>
            <li><a href="#debug-mode">Debug Mode</a></li>
            <li><a href="#running-jobs">Running Jobs</a></li>
            <li><a href="#failure-to-start">Failure to Start</a></li>
            <li><a href="#low-performance">Low Performance</a></li>
            <li><a href="#checking-log-files">Checking log files</a></li>
            <li><a href="#server-logs">Server logs</a></li>
            <li><a href="#rules-debugging">Rules debugging</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="troubleshooting-server">Troubleshooting Server</h1>
<h2 id="isolate-the-problem">Isolate the Problem</h2>
<p><img alt="Layouts Flow" src="../../images/server-troubleshoot.png" /></p>
<h2 id="solve-the-problem">Solve the Problem</h2>
<ul>
<li>Start with the client and release.  </li>
<li>Ensure that all the steps are followed.  </li>
<li>Include any information used in troubleshooting logs, release testing etc that may help identifying the issue.  </li>
<li>Any error must be accompanied by the corresponding log entry.  </li>
<li>Check the knowledge base first.  </li>
<li>Ask for help in the Support Room only.  </li>
<li>Add knowledge base article.  </li>
</ul>
<h2 id="log-levels">Log Levels</h2>
<p>To increase the log levels, navigate to  <strong>Services -&gt; Properties -&gt; Logging</strong>  </p>
<ul>
<li>Select the <strong>appropriate log level</strong> and click <strong>Update</strong>.  </li>
<li>Select the log level: <code>TRACE = highest amount of information</code>, <code>ERROR = Lowest amount of info</code>.  </li>
<li>Select whether the increased logging level should remain after restart. It is recommended to not keep DEBUG and TRACE levels for extended period.  </li>
<li>Click <strong>Update</strong>. </li>
</ul>
<h2 id="rebuilding-indexes">Rebuilding Indexes</h2>
<p>To rebuild all indexes, Navigate to <strong>Services -&gt; Tasks -&gt; Indexing</strong>  </p>
<ul>
<li>Run a <strong>Repair all indexes</strong> when the indexes are mostly complete and there is only some out of date data.  </li>
<li>Run a <strong>Rebuild all indexes</strong>, when there is no index data.  </li>
</ul>
<h2 id="message-queues">Message Queues</h2>
<p>To clear / restart message queues:  </p>
<ul>
<li>Navigate to <strong>Services-&gt;Messaging</strong>. Select the <strong>message queue</strong> and</li>
<li>Click <strong>Reprocess Failed/Dead</strong> to reprocess messages.  </li>
<li>Click <strong>Clear All</strong> to clear any messages out of the queue.  </li>
</ul>
<blockquote>
<p>WARNING: this may produce unexpected results e.g. partial email delivery, failed conversions not being retried etc.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Loggers</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>IndexUpdate.replicate</td>
<td>Index replications queue</td>
</tr>
<tr>
<td>IndexUpdater.update</td>
<td>Updates to the search indexes</td>
</tr>
<tr>
<td>EmailNotifierImpl.sendQueued</td>
<td>Queued email messages</td>
</tr>
<tr>
<td>Rule.generatePdf</td>
<td>Office -&gt; PDF and Flash conversions</td>
</tr>
<tr>
<td>Rule.*</td>
<td>Any asynchronous rule invocation</td>
</tr>
<tr>
<td>replicate</td>
<td>Data replication</td>
</tr>
<tr>
<td><store>.write</td>
<td>File replications and online cloud backups</td>
</tr>
</tbody>
</table>
<h2 id="debug-mode">Debug Mode</h2>
<p>To start PaperTrail in Debug Mode in Windows: <br />
*   Start the <strong>console_debug.exe</strong> command line app.  </p>
<p>To start PaperTrail in Debug Mode in Linux: <br />
*   Add the following to the <strong>run.sh</strong> just after the java command:   </p>
<pre><code class="javascript">-Xdebug  
-Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n  
// Ex : java -Xdebug -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n -Xms512m -Xmx512m -XX:MaxPermSize=196m -classpath $(echo ../build/*.jar ../libs/*.jar . | sed 's/ /:/g'):conf com.egis.Startup
</code></pre>

<h2 id="running-jobs">Running Jobs</h2>
<p>Any long running job will be listed under <strong>Services -&gt; Jobs</strong>. These include:  </p>
<ul>
<li>Scheduled Rules.  </li>
<li>Index Repairs / Rebuilds.  </li>
<li>File Store Repairs.  </li>
<li>Database Backups / Restores.  </li>
</ul>
<h2 id="failure-to-start">Failure to Start</h2>
<p>If PaperTrail fails to start, follow these steps :  </p>
<ul>
<li>Check that <strong>Java is installed</strong> and no other service is listening on the default port.  </li>
<li>Verify that the <strong>database is up</strong> and <strong>accepting connections from the configured user/password</strong>.  </li>
<li>Verify that user, service run as user <strong>has appropriate permissions to read and write to all directories</strong> in the installation directory.  </li>
<li>Review the log files under logs - specifically <strong>error.log, output.log, server.log</strong>.  </li>
</ul>
<h2 id="low-performance">Low Performance</h2>
<ul>
<li>Check the <strong>memory usage</strong>. Take a snapshot and review the vminfo.txt file, the total GC time should be <strong>below 1% of uptime</strong>. If the total GC time is higher, it indicates that the <strong>heap space should be increased</strong>.  </li>
<li>If running on a <strong>virtualization platform</strong>, ensure the host has enough resources.  </li>
<li>Check to ensure that there is enough <strong>IO capacity for the application</strong>.  </li>
<li>Verify that <strong>3rd party application</strong> is not utilizing CPU, RAM and IO resources.  </li>
<li>Verify that the Database has <strong>enough RAM and IO capacity</strong>.  </li>
<li>Verify that <strong>database indexes are created</strong> and statistics are up to date.  </li>
<li>Review thread dump at <a href="http://host:8080/snapshot/threads">http://host:8080/snapshot/threads</a> for threads with high CPU usage.  </li>
<li>Verify best practices.  </li>
</ul>
<h2 id="checking-log-files">Checking log files</h2>
<ul>
<li>Go to <a href="http://host:8080/web/admin/log.html">http://host:8080/web/admin/log.html</a>.  </li>
<li>Take a snapshot <a href="http://host/snapshot">http://host/snapshot</a>.  </li>
</ul>
<h2 id="server-logs">Server logs</h2>
<p>To access the server logs, access the web log console at https://my-uat.papertrail.co.za/web/admin/log.html .</p>
<h2 id="rules-debugging">Rules debugging</h2>
<p>If you expect some rule to be applied to created/updated/deleted document and it doesn't it's probably because that 
document doesn't get covered by rule's source conditions. </p>
<p>To see if that's the case, set <code>com.egis.index.query</code> to DEBUG 
in <strong>Services -&gt; Logging</strong> admin section. And then you'll see the SQL queries and their result set counts in log console.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2016 Egis Software</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../extra.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
